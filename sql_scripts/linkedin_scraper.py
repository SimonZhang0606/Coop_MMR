from linkedin_api import Linkedin
from credentials import email, pwd
import mysql.connector

import uuid

import hashlib
from pprint import pprint

HASH_DIGIT_NUM = 9

def get_uuid():
    return str(uuid.uuid4())


def connect_mysql():
    mydb = mysql.connector.connect(host=MYSQL_HOST,
                                   user=MYSQL_USER,
                                   passwd=MYSQL_PWD,
                                   database=MYSQL_DB_NAME)
    return mydb


def insert_student(name, term_data):
    insert_command = 'INSERT INTO {0} (PID, SID, CID, Title, StartMonth, StartYear, EndMonth, EndYear'.format(
        TABLE_NAME)

def hash_string(s, digit_num):
    return int(hashlib.sha256(s.encode('utf-8')).hexdigest(), 16) % 10 ** digit_num

api = Linkedin(email, pwd)

usernames = ['shane-ding', 'ahlaw', 'irenelrc', 'gaoxk', 'ikshita-yadav-4b091219b', 'kcmyang', 'jason-qin', 'kushbhagat', 'sherman-grewal', 'angela-zhang-uw', 'sheikh-t-b066a7b7', 'mhucanada', 'rishabhsamb', 'aziz-safri', 'ethanjiang4', 'zonggao-li-03823118a', 'yu-sam', 'arunikadhal', 'jack-bai', 'matthewvidov', 'tianhuiyang', 'eric-zhai', 'maggieshan', 'tushar-sekhri-72065b148', 'bob-h-167a08146', 'yuqing-sunny-huang', 'meixin-zhang', 'denisltatar', 'jennyjq', 'bilaalhussain', 'georgeyu26', 'kellyjia', 'emily-anas', 'jasminekbal', 'lingyi-mu', 'kaisun314', 'olivia-xie', 'lilahuang', 'wangwillson1', 'bonniepeng', 'rahul-sirwani', 'xiaohan-jason-ma', 'yiwendai', 'kevin-y-chu', 'estelle-zk-w', 'joshua-gomes-99041a151', 'yuxuan-ji', 'boyi-li-7a2104179', 'vivian-liu-', 'rojigan98', 'caitlynzhang', 'prabhapaar', 'dcostiuc', 'vy8', 'tiger-kong', 'davidjhlu', 'pranavanp', 'miguelcaringal', 'jack-liu', 'jianyuanbobsu', 'the-ericwang35', 'andy-bao', 'stanleywongus', 'anna-xing', 'song-joon', 'aashritluthra', 'muhammad-arham-waqar', 'albertdlee', 'sakinamithani', 'andrew314', 'sylvia-zhang-898a05144', 'a224liu', 'lindsaytoffolo', 'matthew-sun-46075913a', 'caiusbranda', 'frankchen70', 'yu-tong-liu', 'harryzhao001', 'jeff-zhang-2000', 'yongda-fan', 'tonylizj', 'colinwng', 'kevin-bacabac-27631b186', 'dean-jiao', 'sidsharma3', 'm-muhunthan', 'mrkarezina', 'frankfan8', 'vlad-rosu', 'shreyaskprasad', 'p23he', 'justun-lynn', 'prakriti-dhir-2000', 'basimsahaf', 'luis-xhemollari', 'bosen-qu', 'talonjin', 'dymo', 'hanwenzhang-wendy', 'aydanjiwani', 'angiepyw', 'jimyang9788', 'longman-xu', 'jeffer-jingfei-peng-b41376136', 'kevintrieu1', 'mikhail-szugalew', 'huarichard0', 'annabkis', 'andrew-zaki-486414176', 'sam-lii', 'mary-sybersma', 'hamzah-shahid-327889153', 'spencerwilson4', 'ryan-tang', 'lucyhan246', 'josh-jo1', 'david-petkovsek', 'helenxiia', 'suryakrsh', 'reyanshpatange', 'w532li', 'xianglei-xu', 'farzanbhuiyan', 'bill-duge', 'simeng-he', 'avi-v', 'yichuan-qiu', 'ally-fang', 'martin-kf-lui', 'cristian-palage', 'alricj', 'hassaansami', 'njren', 'malvika-patel-b325431b2', 'nathankuanjiang', 'ojas1607', 'calixhuang', 'zaki-machfj', 'gurveer-grewal', 'haley-song-1a78aa1a0', 'ding-kevin', 'isha-chaudhry-26b3891ab', 'ashish-selvaraj', 'psudhaka', 'xintong-li-8b92991aa', 'wallace-long-863463a7', 'ethan-hong-1b4a09207', 'billy-jin-891b17156', 'diyar-yasin-6a7150188', 'tonysongg', 'itsraveensingh', 'sean01zhang', 'albina-babuk', 'cecilia-qiu-9b6242207', 'linhnhifm', 'geraldine-mendoza', 'shradhamenon', 'dayouliu', 'ericdluo', 'agvarun007', 'allenzhang-2001', 'carissatang', 'manveer-tamber', 'michael-oren-7253a1119', 'albert-qin', 'santiago-montemayor-gomez-3a54091a4', 'yushuo-han', 'botao-wei', 'apocol', 'hammam-gaddour-b5a845155', 'jeni-liu-139277163', 'daniel-peng', 'kate-larson-a8405516', 'shai-ben-david-914b1816', 'mingze-xu-70240416a', 'anubhav-srivastava-60bab610a', 'kefei-li', 'benjaminpelletier', 'hari-udhayakumar-00951389', 'jian-li-22337396', 'advait-m', 'mingyu-liu-8215541a0', 'vleni', 'diyang100', 'victor-s-wu', 'tyxchen', 'williamuw', 'katiezhan', 'kartikey-sinha', 'wen-z-waterloocs', 'richadalal', 'dhanush-mohan-kumar-23790b184', 'paul-hyungwon-cha-58a198128', 'kaushal-maganti-aa296a121', 'miaoqi-zhang-543088175', 'cameron-seth-36735369', 'timur-khayrullin-790882164', 'anshpreet-sandhu', 'padamchopra', 'rayyan-khalid-0b3631172', 'eveyu0130', 'austin-huang-85b1049a', 'stefanie-low', 'mona-deng', 'juliajl', 'theodore-vanderkooy', 'ygyoon', 'nathan-wiebe-neufeldt', 'mehul-kumar-2579021a1', 'isa-w', 'jason-zhang-1534501a4', 'sebastian-negulescu', 'hoomanfarhadi', 'ruofanluo', 'suleyman-suleymanov-b72066110', 'nrobinson12', 'zhi-wei-wang', 'john-huang135', 'simonlee9504', 'alyssa-lyons-', 'balpreet-mangat', 'ahamedabdi', 'sanyasiwal', 'gordon-duan-100190184', 'trinhvev', 'reneelyleung', 'lyixwang', 'camelianunez', 'dang-michelle', 'lu-yang-268289169', 'yufeng-ge-748689127', 'tahmeed-mostafiz', 'richard-woongbin-choi', 'roselynxu', 'huang-micah', 'janvipatel', 'yuhua-xiang-49b5a6182', 'judy-cai-674972123', 'willhlu', 'susnchen', 'cheryl-lin-yigi', 'anna-westland-tegart', 'minghan-li-146389121', 'alex-de-wit', 'amandavaloppi', 'jingtong-hu', 'junozhu', 'ziwei-han-757b00143', 'mdnafees', 'payton-zhong-269b9a185', 'karanbhandari96', 'hemika-roy', 'evanwild', 'kevin-pan-889098135', 'schnellj', 'ben-lin-b6204119a', 'z24tao', 'berkay-dogan', 'michaellegacy', 'justin-goping', 'sally-x-83ab66152', 'mingmeih', 'pranavpsv', 'patrick-sokol', 'desmond', 'das-utsav', 'lawrence-wu-5a114a127', 'clzheyang', 'joanne-wuu', 's3kala', 'guystoppi', 'ericliuu', 'nicholas-xie', 'michael-ding-37a83aa6', 'sreeharshau', 'snehitkhair', 'kpatel5797', 'imjching', 'joseph-sumabat', 'lily-zhang-506ba7101', 'ayesha-siddiqa-a31763211', 'aspen-santos-356220156', 'aroraritik', 'krishanpatel2002', 'karen-wang-34419b156', 'dongni-lu-4aa17a17a', 'ross-evans-6a6218156', 'alastair-cranston-962778141', 'qishen-wu-1943611a9', 'psharma97', 'prlinger', 'andrewbatek', 'danielzhaotongliu', 'ashlynwu', 'richellali', 'samantha-zhan-4954b0172', 'jeffreyzhang2001', 'adparekh', 'marcia-taylor-57817412', 'shanccui', 'jetashree-ravi', 'tszyanau', 'william-vu', 'mithran-roy-1741b2168', 'xiao-david', 'mahan-sharifi-05447b1ab', 'allysonxu', 'harsh-agrawal-a090aa152', 'joell-sebastiampillai-89510b1b0', 'julien-ouellette', 'jathurshan-t', 'richard-zhang-65z', 'ricky77768', 'yuktesh-m-714aa91a8', 'ivan-zdane', 'liu-russell', 'tenzin-pelletier-a0391b1b8', 'william-yang-418401173', 'sukhsimran-grewal-984065209', 'patrickxiee', 'ramya-kottapalli-158875210', 'yug-manavadaria', 'alan-wang11', 'sherry-l-219652203', 'allenlu', 'alvin-zhang-05b105199', 'alex-guo-053023172', 'jing-yi-wang', 'kevin-yang-137926198', 'bogdandobreanu', 'rushigandhi', 'angela-phoenix-zhou', 'celina-tang', 'alexshi0000', 'bowenzhu1', 'lucaswangto', 'ug8', 'maitry-mistry', 'shivam-saraf11', 'jackzhang7', 'hyunzeekim', 'nigelqiu', 'hansson-lin', 'vuk-marekic-625867112', 'koro-yiyang-hu-1336801a2', 'chih-li-wang-b422b7194', 'ben-wannan-23442a199', 'siddharthgupta01', 'cong-celine-gu', 'larfy', 'andrew-zhan', 'reyna-lu-69895b171', 'bransonl', 'hao-tommy-li-9ba22b141', 'camhw', 'stephenjhwang', 'tian-gigi-wang-b57957175', 'gxjin', 'guang-yao-he-6603a9139', 'dylex-suan', 'victor-scurtu-2a3332135', 'fionzheng', 'barbaraguo', 'louisboileau', 'mylonsuren', 'ian-lavallee', 'kelva-keying-zhou-191315150', 'liu-susan', 'vraj-p-b46040134', 'ankita-george-aa3186145', 'ville-zhao-2b3a3b155', 'hsaxena90', 'alyssa-song', 'shrey079', 'logan-grier-7a9193187', 'shuxin-ye-emily', 'kaiwen-chen', 'bensonguo', 'da-peng', 'tony-zhang-441093135', 'gian-cordana-sanjaya-342924186', 'filipzieba', 'adam-vandolder-67a185129', 'miaoyouchen', 'xiang-wil-tan', 'ryan-kwan', 'george-yang-5a86b5155', 'xiangyuan-zeng-453696111', 'mshanjer', 'oliver-odendaal-5871a915b', 'chu-qin-4a359b168', 'liphenste', 'alicia-h-98055976', 'steven-huang-747612186', 'jerry-zhu1', 'wei-min-loh', 'kiking0501', 'stefanmanoil', 'arshvirchaudhary', 'sahij-hayer-1015b1180', 'sarah-pu', 'ajay-sharma-66b90b15a', 'tianlizhan', 'jonathan-yoni-nesher-b9b9a0170', 'jaysonlou', 'hongjian-zhou-2644b1191', 'ada-vu', 'kenneth-li-09b085194', 'farhan-kamal-448b99179', 'craig-eric-lewis', 'ivan-nesterovic', 'shsuh', 'kevin-na-0b1565105', 'jayden-chiu', 'advamasliah', 'loktu', 'elaine-zhong-415464179', 'ben-quinlan-06b835128', 'zaid-alsaigh', 'christian-kapsales', 'bihan-allison-liu-453952186', 'arsen-cui', 'raphael-shawn-gozali-902923186', 'irvineyao', 'vincent-yang19', 'julien-he', 'kwan-yoon', 'jase-wu', 'asghar-taqvi', 'antarpreet', 'jason-kelly-cs-biz', 'kenyrishi', 'shirley-wang-59a258163', 'adeitdalal', 'kanwarpal-brar', 'william-jiang', 'jlucki', 'danduranro', 'mihai-mitu', 'nandika1312', 'kai-yi-zhang', 'anvita-gupta', 'henry-zhang-abbb2713b', 'brdmyldz', 'jaimee-yeung', 'deepparmar02', 'andrew-kang4', 'ellisshang', 'trevor-sun-772650124', 'xuejun-du-403046142', 'edward-pei-b5b78619b', 'matthew-switt-11837613b', 'arist-xu-3a0a1518b', 'abhqy', 'preesharuparelia', 'alanywei', 'jack-shan-nan-c-216b43205', 'abhayksharma', 'alanna-eybel', 'adriandavila1', 'jatinvir-matharoo-a8a0b0211', 'mattheweliass', 'tarun-velicheti-646018207', 'kriti-sodhi-629a981b5', 'alfred-von-a0538a1b6', 'abtin-a-tabrizi', 'sharmistha-ghosh-7086ab212', 'maura-bradley-5355371b5', 'jacob-meksavanh', 'jessica-r-chan', 'shirley-wang-9307b81b5', 'ethan-wellenreiter-31524b212', 'bhavya-shah-103a431b8', 'jackmogen', 'n-antia', 'denis-kontorovich779', 'sanat77', 'narein-chenthivelnathan-a7b8191b1', 'li-jacqueline', 'siyao-c', 'taehyun-lee-uw', 'masalahuddin', 'zibai-sean-wang', 'longinus-wang-8a151b131', 'tian-kou-aa607412', 'dave-l', 'harshalbrahmbhatt', 'arielle-shannon', 'hannahzakinthinos', 'navya-mehta-uj', 'edmondz2001', 'fangyuu', 'nathanlo', 'matteo-palarchio', 'marcmailhot', 'cindykxliu', 'colin-wu-cs', 'ruijie-zhang-3b6773a2', 'steven-feng', 'victor-liao', 'john-morgan-1aa618164', 'liamhebert', 'jack-yang-b2618993', 'ifeanyi-okwuchi', 'saswatagupta', 'zhharry', 'siddharth-vagavolu-58204119a', 'racheal-ou', 'cjtorunski', 'dan-berry-b421b6', 'miguel-delrosario', 'samuel-xiaoyang-chen', 'erik-vandenberg-229aa1188', 'j253pate', 'alexistao', 'xialicegao', 'quinn-buratynski', 'sajidbashar', 'anzhou-hou-95823719a', 'jiachen-jason-yan-9a33ab164', 'richardyi25', 'tiger-zhao', 'melodyuann', 'ivan-lam-75603b134', 'nikki-guo1', 'yue-yu-3b896b164', 'avapun', 'ensieh-mollazadeh-8bb28580', 'seif-eldin-ghazal', 'mahad-ali-khan-6398a417b', 'saarangagarwal26', 'arthur-wong-bb243aa9', 'maadhyam-rana-2b99171a9', 'tanavya', 'edward-niu-9497a6172', 'caseykoh', 'besatkassaie', 'yichun-shen', 'mark-morra', 'eliza-y-sun', 'kapilbilimoria', 'brianxwz', 'yiran-cao-uw', 'hujoseph99', 'bryant-curto-216907134', 'meena-de-schutter-194297127', 'ishankap', 'dlao', 'jason-z-a49261131', 'anthea-shiyi-li-06216214b', 'brianvuong8', 'ashna-jagadisan', 'impeterlin', 'joshua-lemmon-b15b71142', 'jenniferxing9', 'anurag-sake-155057141', 'charlotte-chen-053572180', 'eric-qiu', 'karinasang', 'juntian-zheng', 'mohammedoonwala', 'max-odell', 'felixzheng98', 'shizhi-becky-zhao-243182149', 'marc-bhopalsingh-30a7511b6', 'mohamed-malek-abid', 'itsjennynguyen', 'w465wang', 'ernest-wong-canada', 'lemichael88', 'nuri-amari', 'victorkabugo', 'alexander-faassen', 'ethanxue026', 'chris-bobotsis', 'wael-al-manasrah', 'ethan-pronev', 'guneet-bola-77ab821a7', 'taiki-maekawa-07b85b13b', 'abhishek-singhi-a3009579', 'tansonlee', 'benboonsiri', 'andrew-w-ib45', 'jasonleejongseok', 'rpradeep42', 'marzuk-mashrafe', 'logan-maier', 'jamiesebastian', 'yang-ji-4590041ab', 'kexin-cindy-yuan-4775a31aa', 'garysun3698', 'jennifer-yu-7442b1181', 'vgk1106', 'brad-stevanus', 'andrew-zhang-42379a19b', 'xinrong-qiu', 'karneet-kaur-2b0217198', 'jessica-bohm-11799a1b2', 'dereck-tu-39b331183', 'danyang-wang-1426b3198', 'sustvero', 'william-gao-459b75171', 'nikola-petrov-0492911b1', 'chenxi-michael-zhang-026729139', 'serena-shen-37b2861a0', 'zhu-owen', 'kefan-cao-2801bb165', 'mathurshan-nadarajar-8abb63183', 'a-abdulhamid', 'asdera', 'mzhang181', 'aman-pal-singh', 'preeti-valunjkar', 'anthony-maocheia-ricci-83b23619a', 'dong-andrew', 'devinzhou', 'brittany-wong-161133212', 'sohom-g-2k2', 'niki-hasrati', 'enoch-wei-b9b5a0204', 'serena-meng-8150b61a7', 'frankslin', 'conor-lamont', 'andy-zhao-6a386a203', 'muhammad-hamza-zaman', 'jennifer-zhu-2546321b6', 'annalisayin', 'ru-ming-shi', 'thebes2', 'andrei-gliga-809615202', 'yikangw7', 'jerrywei1', 'jagansahu', 'mikaelatang', 'gregory-moroie', 'gillian-xuu', 'laiba-zaman', 'betty-guo', 'shivani-nagpal', 'qhyun', 'krishna-khajuria-450473179', 'dylan-snelgrove', 'snehal-sagun-5bb5b0198', 'jack-douglas-910896150', 'sliewatc', 'sophia-pietsch-007749178', 'kenneth-cui11', 'alex-gheorghe-36809a54', 'rohanminocha', 'ziyao-tian', 'hossein-mohebbi', 'markyhzhang', 'sajidbsk', 'aryanved', 'jaclyndchan', 'angelo-lao', 'sherryhanxiaoli', 'mashrurc', 'joyce-shi', 'mayank-shrivastava21', 'michael-zou', 'tonytascioglu', 'lily-li-uw', 'jackiechen73', 'kaveenk', 'yuxiangsun', 'james-bundgard-961907178', 'laindon-burnett-math-cs', 'christineeunseolee', 'ericl816', 'aeweston', 'poojabahukhandi', 'charles-y-zhang', 'zenan-eric-jiang', 'norman-chong-6608b718a', 'farzanfaghihi', 'tejas-pandit', 'michaelkim314', 'k-lu', 'hector-xinhai-wei-9993841a0', 'ashfi-pathan', 'sharan-patel', 'ray-ruizhe-li', 'hossein-rajabzadeh-95857a77', 'arthur-yunjian-liao-755b246b', 'mohamed-abdall', 'andrew-xue-1847a8131', 'victor-sun-69056416b', 'pedram-mollahajian', 'zhilinzhou', 'amanda-tang-0111', 'alexei-frolov', 'andy-yizhou-huang-a0901123', 'roy-liu-47369a119', 'ayushtron', 'neil-sharma123', 'maciejkalisiak', 'starxie', 'matthewwalinga', 'hoseok-lee-388548165', 'karam-abuaisha', 'vic-diciccio-b33b321', 'atharvagangal', 'dinnywang', 'chengbo-li-b824a032', 'mathyou-wolfe', 'matt-buckley-a55390149', 'khoa-nguyen001', 'dylan-tinianov', 'kemarsthill', 'mumtaz-ahmad-212b856', 'shihong-pan-a5aabb194', 'orelshikher', 'netramali', 'hoangnhat', 'sameerkhan5669', 'jasmine-xu-a3a74314b', 'haowei-zheng-377362136', 'yetianw', 'sue-zanne-ling-098951120', 'chenabel', 'haeimlee', 'mijia-shen', 'lai-wei-6b976117a', 'binzhan', 'ameliaazhao', 'jerryyang22', 'jason-wolter-917217186', 'jugal-bilimoria', 'jess-zhang-6266b3173', 'zi-yue-yang', 'donglin-jia', 'frank-yu-441213173', 'sherry-xu-885a26177', 'katmuszynski', 'jack-zhang-537b6017b', 'jackericksonyyz', 'jeremy-sun', 'conmur', 'davidchi8', 'gaurav-gupta-uw', 'minjaelee0727', 'yuxiao-zhao-652908193', 'james-ouyang', 'joe-scott-bb319565', 'kirsten-wong', 'isaiah-witzke-4990a6175', 'sindhura-thirumal', 'shawn-liu-399448170', 'jo-ann-hardy-7b506013b', 'jshrivastava99', 'aaron-sarson', 'zoravur-singh', 'noahjch', 'shahzaibbalii', 'gautamb1', 'kn-liu', 'sw4wang', 'emily-da-silva', 'nick-lee-b0875b17a', 'francie-chen-a82270120', 'johnny-leung10', 'rahulgudise', 'arun-atchuthananthan', 'kevin-jin-3a1096191', 'lyestria', 'juangomezgonzalez', 'joseph-perez-701357173', 'itsanirbandutta', 'alexnainer', 'maggie-li-a89289160', 'jerry-cheng5', 'mahzabin-rashid', 'diana-brebeanu', 'saumyakhati', 'shruti-b-791626100', 'krish-chandarana-25a197177', 'bill-li1', 'janet-wang', 'jennie-jia-xin-chen', 'austin-robert-wright', 'jaiminjaffer', 'shayn-adatia-086386202', 'jaredhe', 'gopal-reghu-33a633213', 'yifei-kristine-yuan-2626a6211', 'anita-zhang-183580212', 'ninjaclasher', 'yunji-zhang', 'avani-agarwala', 'axel-leiva-treminio', 'mehar-shienh', 'sam-gunter', 'cathleen-yan-ab90481b8', 'yilin-ding', 'egan-khomasurya', 'chaochingchang', 'yifei-zhang1', 'cindywang328', 'csdeguzman', 'vishv-patel', 'abhi-jhanji', 'gmudbhat', 'lazar-vukoje-36b792163', 'thomas-aryawan', 'kaiyuan-chi', 'sanjani-mithani', 'julia-jitomirsky', 'yihan-dennis-duan', 'alex-bajenaru', 'dhvani35729', 'chengzhang1stap2star3swag', 'lambert-liu', 'arihantkothari17', 'tiancheng-yang-740873145', 'gabe-gu', 'alexieyizhe', 'komiamiko', 'yangchen3', 'jacob-brunsting-021a25126', 'william-t-law', 'kevin-hoxha', 'amjiwani', 'lee-fryer-davis-71b194', 'aliceranzhou', 'masijia-qiu', 'prabh-simran-singh-badwal-6895b016a', 'sohamshah06', 'sahil-pahooja', 'sgmenda', 'josephchengdev', 'wen-liang-feng', 'gaurav-baruah', 'xiaoye-lan-45697a59', 'kushanzaveri', 'junjie-he-013511170', 'mohammadreza-n-239a30a6', 'jasper-xu', 'alvin-jin', 'zixiao-bryan-qiang-937904119', 'wanda-song', 'surya-murugaian', 'andyc12', 'manitzaveri', 'hanan-ayad-ba39839', 'sylvia-siyu-liu', 'arshdeep-kaur-bal', 'noredeen', 'noumaank', 'stanleyxuu', 'mason-johnson-a173b61b2', 'aritra-kar', '~dy', 'myanne', 'ibelemari-kio', 'ziyu-wang-433b4614', 'swastiekhan', 'andre-chan-86a304b9', 'lafrenben', 'xi-han-73a83639', 'hamdanjaveed', 'jack-kyung-jae-lee', 'billy-weizhen-li-9088211b1', 'djiang9001', 'wais-hundekar', 'rs-shruti', 'jack-h-574a94198', 'rui-qi-fu', 'gabrielle-lu-6ba542165', 'iamhyang', 'zhi-heng-lu', 'jessica-lee-0989141a1', 'amyluo42', 'yw-zhou', 'jie-wu-49409739', 'jbrajer', 'mamunawar', 'minglei-li-361058158', 'alancmathew', 'noel-v-052435128', 'joseph-poremba', 'jacksonenright', 'jasonhao', 'eddie-kim-85a406169', 'sabeeh-malik', 'avery-lin-988516184', 'brianptu', 'vaarananyogalingam', 'mahmoud-faraj-66163a182', 'wnnluu', 'siwei-yang-a2524613', 'leeminkyu16', 'jfavery', 'yunjia-sun-4b3b2280', 'alexguo8', 'conlin-dubois-3a3379172', 'joe-liang-89059a17a', 'ming-huang', 'lik3673', 'minafarid', 'zahra-sheikhbahaee-49657079', 'roberttoyonaga', 'jesse-elliott-8ba49aa7', 'jannis-zhang-8417b0193', 'farbody', 'dawei-w-900697109', 'caesar-feng', 'yash-rohatgi-9a84b0172', 'avandekleut', 'cosmin-marcu', 'lew-fraser-a28a9161', 'alex-tobias', 'xi-li-8218b861', 'sebvillate', 'mahsa-emami-taba', 'nina-tan', 'zchelseal', 'yagao-gracelyn', 'yusuming', 'huan-yi-shen-b496321b3', 'sarah-yu-087137187', 'descrip', 'jessica-peter-01', 'azin-nazari', 'rijin-muralidharan-952ab3182']

for user_idx, username in enumerate(usernames):
    profile = api.get_profile(username)
    # pprint(profile)

    # student
    student_name = "{} {}".format(profile['firstName'], profile['lastName'])
    sid = hash_string(student_name, HASH_DIGIT_NUM)
    program = profile['education'][0]['degreeName']

    try:
        enrol_date, grad_date = profile['education'][0]['timePeriod']['startDate']['year'], profile['education'][0]['timePeriod']['endDate']['year']
    except Exception as e:
        print('{}: Missing data for education. Record omitted.'.format(student_name))
        continue

    student_tsv = "{}\t{}\t{}\t{}\t{}".format(sid, student_name, program, enrol_date, grad_date)

    print(student_tsv)

    omitted_term_count = 0
    total_terms = len(profile['experience'])

    for i, term in enumerate(profile['experience']):
        
        start_year, start_month = term['timePeriod']['startDate']['year'], term['timePeriod']['startDate']['month']

        if enrol_date >= start_year:
            continue

        # company
        company_name = term['companyName']
        cid = hash_string(company_name, HASH_DIGIT_NUM)
        company_tsv = "{}\t{}".format(cid, company_name)

        print(company_tsv)

        # job
        job_title = term['title']
        jid = hash_string(str(cid) + job_title, HASH_DIGIT_NUM)
        job_tsv = "{}\t{}\t{}\t{}".format(cid, jid, 1500, job_title)

        print(job_tsv)

        # placement
        salary = -1 # determine it later
        
        start_date = str(start_year) + '-' + str(start_month)

        if 'endDate' in term['timePeriod']:
            end_year, end_month = term['timePeriod']['endDate']['year'], term['timePeriod']['endDate']['month']
            end_date = str(end_year) + '-' + str(end_month)
        else:
            end_date = 'N/A'
        
        pid = hash_string(str(cid) + str(jid) + str(sid), HASH_DIGIT_NUM)

        placement_tsv = "{}\t{}\t{}\t{}\t{}\t{}\t{}\t{}".format(cid, jid, pid, sid, 
                        total_terms - omitted_term_count - i, -1, start_date, end_date)
        
        print(placement_tsv)

    if user_idx > 10:
        break
